#!/bin/bash
#

CTAGS_PARAMS="-R --sort=1 --c++-kinds=+p --fields=+iaS --extra=+q"

rm -f tags cscope.*

find -L -maxdepth 1 -mindepth 1 -type d ! -name ".*" ! -name "doc" >cscope.dirs
echo "/usr/include" >>cscope.dirs
echo "/usr/local/include" >>cscope.dirs

if test -e exclude.kgy
then
	cat exclude.kgy | (
		read name
		my_excludes="$my_excludes --exclude=$name"
		sed -i -e "s%./$name\>%%" cscope.dirs
	)
fi

find -L `cat cscope.dirs` -name "*.[ch]" -o -name "*.cpp" -o -name "*.cc" -o -name "*.java" >cscope.files

/usr/bin/ctags $CTAGS_PARAMS -L cscope.files

sed -i -e "s/ /\\\\ /g" cscope.files
/usr/bin/cscope -R -b -q

# rm cscope.files cscope.dirs

